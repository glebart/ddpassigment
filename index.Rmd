---
title       : DDP course project
subtitle    : shiny with leaflet
author      : me
job         : ---
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : []            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
knit        : slidify::knit2slides
github:
  user: glebart
  repo: ddpassigment
---

## Read-And-Delete

1. Edit YAML front matter
2. Write using R Markdown
3. Use an empty line followed by three dashes to separate slides!

--- .class #id 


## List of countries by intentional death rate.

You will find here an interactive map for yearly intentional deaths per capita according to a Wiki page: [link](https://en.wikipedia.org/wiki/List_of_countries_by_intentional_death_rate).

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(data.table)
library(magrittr)
library(XML)
library(RCurl)
library(rlist)
library(plotly)
library(leaflet)
options(stringsAsFactors = F)
```

## List of countries by intentional death rate.

You will find here an interactive map for yearly intentional deaths per capita according to a Wiki page: [link](https://en.wikipedia.org/wiki/List_of_countries_by_intentional_death_rate).

---

## Intetional deaths a year per 100 000 inhabits

```{r ,echo=FALSE,warning=FALSE}

#getting data
theurl <- getURL("https://en.wikipedia.org/wiki/List_of_countries_by_intentional_death_rate",.opts = list(ssl.verifypeer = FALSE) )
tables <- readHTMLTable(theurl,header = T)
tables <- list.clean(tables, fun = is.null, recursive = FALSE)
idpcpy = tables[[1]]

#formating 
idpcpy %>% setDT()
names(idpcpy) %<>% gsub("[+[(].*","",.) %>% tolower() %>%  trimws()
for (j in names(idpcpy)){
  set(idpcpy,i=NULL, j=j, value = gsub("[+[(].*","",idpcpy[[j]]) %>% trimws()  )}
cols = names(idpcpy)[-2]
for (j in cols){
  set(idpcpy,i=NULL, j=j, value = as.numeric(idpcpy[[j]])  )
}
idpcpy = idpcpy[!is.na(ratio)]
bins <- c(0, 5, 10, 20, 30, 40, Inf)
pal <- colorBin("YlOrRd", domain = idpcpy$`intentional death`, bins = bins)

p <- plot_ly(
  idpcpy, x = ~suicide, y = ~homicide,
  type ="scatter",
  mode = "markers",
  size = ~`intentional death`,
  # Hover text:
  text = ~paste("Country ", country, '<br>Rank:', rank, '<br>Intentional deaths:', `intentional death`),
  color = ~`intentional death`, colors = colorRamp(c("green", "red"))
)
p
```

---

## Thank you.